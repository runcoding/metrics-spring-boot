<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <title>æœåŠ¡ç›‘æ§ä¸­å¿ƒ</title>
    <meta name="description" content="æœåŠ¡ç›‘æ§ä¸­å¿ƒ">
    <meta name="viewport" content="width=device-width, user-scalable=no, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0">
    <link rel="stylesheet" href="/dist/docsify/themes/vue.css">
    <link rel="stylesheet" href="https://cdn.bootcss.com/amazeui/2.7.2/css/amazeui.min.css" />
    <link rel="stylesheet" href="/dist/json/jsoneditor.min.css">
    <link rel="icon" type="image/png" href="/dist/docsify/media/favicon.ico">
    <style>
        .markdown-section {
          padding: 10px 15px 40px;
          max-width: 100%;
        }
        .markdown-section ul {
           margin: 0.2em 0;
        }
        .markdown-section td, .markdown-section th {
          border: 1px solid #ddd;
          padding: 1px 10px;
        }
        .markdown-section a {
          color: #42b983;
          font-weight: 500;
          text-decoration:none;
        }
        .sidebar {
            width: 180px
         }
  </style>
</head>
<body onload="">
<div id="app">æ­£åœ¨åŠ è½½â€¦â€¦</div>
<script type="text/javascript" src="/dist/mermaid/mermaid.js" ></script>
<script src="/dist/json/json-to-table.js"></script>
<script>
    String.prototype.replaceAll = function(s1,s2){
        return this.replace(new RegExp(s1,"gm"),s2);
    }
    var  baseDomain  = window.location.href.split("#")[0].replaceAll("monitor/index.html","");
         baseDomain  = baseDomain.split("?")[0].replaceAll("monitor/index.html","");

    var  staticDomain =  window.location.host == "localhost:8080" ? baseDomain : "/dist/";

    function getQueryParam () {
        /**è·å–urlä¸­"?"ç¬¦åçš„å­—ä¸²*/
        var url = location.search;
        var theRequest = new Object();
        if (url.indexOf("?") != -1) {
            var str = url.substr(1);
            var arr = str.split("&");
            for(var i = 0; i < arr.length; i ++) {
                var obj = arr[i].split("=");
                theRequest[obj[0]] = decodeURIComponent(obj[1]);
            }
        }
        return theRequest;
    }
    localStorage.clear();
    /**è‡ªå®šä¹‰èœå•*/
    var  modelSidebar = getQueryParam().sidebar || 'monitor';

    var sidebar  =  "wiki/sidebar";
    var homepage =  "wiki/home.md";

    if(modelSidebar){
        sidebar   = modelSidebar + "/" + sidebar+".md";
        homepage  = modelSidebar + "/" + homepage;
    }

    /**æŒ‡å®šæ‰“å¼€æ–‡ä»¶*/
    homepage = getQueryParam().open || homepage;
    window.$docsify = {
        el: '#app',                //åˆå§‹åŒ–çš„æŒ‚è½½å…ƒç´ 
        name: 'æœåŠ¡ç›‘æ§ä¸­å¿ƒ',        //æ–‡æ¡£æ ‡é¢˜ï¼Œä¼šæ˜¾ç¤ºåœ¨ä¾§è¾¹æ é¡¶éƒ¨ã€‚
        nameLink: "monitor/index.html",         //ç‚¹å‡»æ–‡æ¡£æ ‡é¢˜åè·³è½¬çš„é“¾æ¥åœ°å€ã€‚{nameLink:{'/zh-cn/':'/zh-cn/','/':'/'}}
        loadSidebar: sidebar,      //åŠ è½½è‡ªå®šä¹‰ä¾§è¾¹æ ï¼Œ loadSidebar:trueæ—¶ï¼Œé»˜è®¤åŠ è½½_sidebar.md(æŒ‡å®šåŠ è½½ loadSidebar:summary.md)
        subMaxLevel: 8,         //è‡ªå®šä¹‰ä¾§è¾¹æ åé»˜è®¤ä¸ä¼šå†ç”Ÿæˆç›®å½•ï¼Œä½ ä¹Ÿå¯ä»¥é€šè¿‡è®¾ç½®ç”Ÿæˆç›®å½•çš„æœ€å¤§å±‚çº§å¼€å¯è¿™ä¸ªåŠŸèƒ½ã€‚é»˜è®¤subMaxLevel: 0
        loadNavbar: false,       //åŠ è½½è‡ªå®šä¹‰å¯¼èˆªæ , loadNavbar: trueæ—¶ï¼Œé»˜è®¤åŠ è½½ _navbar.md(æˆ–æŒ‡å®šæ–‡ä»¶åŠ è½½loadNavbar: 'nav.md')
        maxLevel: 8,            //é»˜è®¤æƒ…å†µä¸‹ä¼šæŠ“å–æ–‡æ¡£ä¸­æ‰€æœ‰æ ‡é¢˜æ¸²æŸ“æˆç›®å½•ï¼Œå¯é…ç½®æœ€å¤§æ”¯æŒæ¸²æŸ“çš„æ ‡é¢˜å±‚çº§ã€‚
        // coverpage: "cover/cover_page.md",        //å¼€å¯æ–‡æ¡£å°é¢é¡µï¼Œé»˜è®¤åŠ è½½ _coverpage.md æ–‡ä»¶ï¼Œå¯coverpage: 'cover.md'æŒ‡å®šå…·ä½“æ–‡ä»¶ã€‚
        auto2top: true,         //åˆ‡æ¢é¡µé¢åæ˜¯å¦è‡ªåŠ¨è·³è½¬åˆ°é¡µé¢é¡¶éƒ¨ã€‚é»˜è®¤å€¼: false
        homepage: staticDomain+homepage,    //é¡¹ç›®å…¥å£åœ°å€ã€‚é»˜è®¤README.mdï¼Œ
        basePath: staticDomain,    //æ–‡æ¡£åŠ è½½çš„æ ¹è·¯å¾„ï¼Œå¯ä»¥æ˜¯äºŒçº§è·¯å¾„æˆ–è€…æ˜¯å…¶ä»–åŸŸåçš„è·¯å¾„ã€‚
        repo: '',               //æ˜¾ç¤ºgihubå¼€æºé¡¹ç›®åœ°å€ã€‚
        // themeColor: '#3F51B5',  //æ›¿æ¢ä¸»é¢˜è‰²ã€‚åˆ©ç”¨ CSS3 æ”¯æŒå˜é‡çš„ç‰¹æ€§ï¼Œå¯¹äºè€çš„æµè§ˆå™¨æœ‰ polyfill å¤„ç†ã€‚
        autoHeader: true,//åŒæ—¶è®¾ç½® loadSidebar å’Œ autoHeader å,åŒæ—¶è®¾ç½® loadSidebar å’Œ autoHeader åï¼Œå¯ä»¥æ ¹æ® _sidebar.md çš„å†…å®¹è‡ªåŠ¨ä¸ºæ¯ä¸ªé¡µé¢å¢åŠ æ ‡é¢˜ã€‚
        executeScript: true,    //æ‰§è¡Œæ–‡æ¡£é‡Œçš„ script æ ‡ç­¾é‡Œçš„è„šæœ¬ï¼Œåªæ‰§è¡Œç¬¬ä¸€ä¸ª script (demo)ã€‚ å¦‚æœ Vue å­˜åœ¨ï¼Œåˆ™è‡ªåŠ¨å¼€å¯ã€‚
        noEmoji: false,          //ç¦ç”¨ emoji è§£æã€‚ç¦æ­¢åä¸èƒ½æ’å…¥è¡¨æƒ…ğŸ˜Š https://www.webfx.com/tools/emoji-cheat-sheet/
        mergeNavbar: true,      //å°å±è®¾å¤‡ä¸‹åˆå¹¶å¯¼èˆªæ åˆ°ä¾§è¾¹æ ã€‚
        formatUpdated: '{YYYY}/{MM}/{DD} {HH}:{mm}',//æ˜¾ç¤ºæ–‡æ¡£æ›´æ–°æ—¥æœŸ
        externalLinkTarget: '_self', // default: '_blank'
        ga: 'UA-107590401-1',
        themeColor: '#1bb58b',
        notFoundPage: 'monitor/wiki/404.md',
        markdown: {
            renderer: {
                code: function(code, lang) {
                    var jsonEdit = '';
                    if(lang == 'json'){
                       try{
                            JSON.parse(code);
                            var key = new Date().getTime();
                            localStorage.setItem(key,code);
                            jsonEdit = '<a href="/dist/json/json.html?jsonStr='+key+'">ç¼–è¾‘</a>';
                        } catch(e) {
                        } 
                    }
                    if(lang == 'json2table'){
                        try{
                            code = JSON.parse(code);
                        } catch(e) {
                            try{
                               code = eval("("+ code +")");
                            }catch(e2) {
                               code = [{"<span style='color: #ffa666'>è¯·æ£€æŸ¥ä¸‹é¢çš„jsonå­˜åœ¨è¯­æ³•é”™è¯¯</span>":code}]
                            }
                        }
                        return json2table(code,'');;
                    }
                    var html = '';
                    if( lang == 'mermaid' ||code.match(/^sequenceDiagram/) || code.match(/^graph/) ||
                        code.match(/^gantt/) ||  code.match(/^mermaid/) ){
                        var cb = function(svgGraph) {
                            //console.log("svgGraph"+svgGraph);
                            code = svgGraph;
                        }
                        try{
                            mermaid.render('mermaid_'+new Date().getTime(),code,cb);
                        }catch (e) {
                            var baseCode = "#/edit/"+Base64.encodeURI(code);
                            code = "<h5 style='color: #ffa637'>æµç¨‹å›¾è®¾è®¡å­˜åœ¨è¯­æ³•é”™è¯¯ã€‚"
                                 + "<a href='https://mermaidjs.github.io/mermaid-live-editor"+baseCode+"' target='_blank'>æ¨èåœ¨çº¿è¯­æ³•æ£€æŸ¥</a></h5>"
                                 + code;
                        }
                        return '<div class="mermaid" >' + code + '</div>';
                    }

                    var hl = Prism.highlight(code, Prism.languages[lang] || Prism.languages.markup)
                    return html + '<pre v-pre data-lang="' + lang + '">'+jsonEdit+'<code class="lang-' + lang + '">' + hl + '</code></pre>'
                }
            }
        },
        alias: {},
        search:{
            maxAge: 86400000, // è¿‡æœŸæ—¶é—´ï¼Œå•ä½æ¯«ç§’ï¼Œé»˜è®¤ä¸€å¤©
            placeholder: 'æœç´¢',
            noData: 'æœªæ‰¾åˆ°ç»“æœ'
        },
        plugins: [
            function (hook, vm) {
                var footer = [
                    '<hr/>',
                    '<footer>',
                    '</footer>'
                ].join('');
                hook.init(function() { })
                hook.beforeEach(function(md) {
                    return md ;
                })
                hook.afterEach(function(html, next) {
                    var reqParam = getQueryParam();
                    if(reqParam.module){
                        var moduleHtml = staticDomain + "monitor/view/"+reqParam.module+".html";
                        var modulejs   = staticDomain + "monitor/view/"+reqParam.module+".js";
                        /**å¼•å…¥å…·ä½“çš„ç»Ÿè®¡é¡µé¢ä¿¡æ¯*/
                        fetch(moduleHtml).then(function(response) {
                            return response.text();
                        }).then(function(body) {
                            next(body+footer);
                            SystemJS.import(modulejs).catch(function(err){ console.error(err); });
                        }).catch(function(ex) {
                            console.error('åŠ è½½å¤±è´¥ï¼',ex);
                            next(html+footer);
                        });
                    }else{
                        next(html+footer);
                    }
                })
            }
        ]
    }
    if (typeof navigator.serviceWorker !== 'undefined') {
       // navigator.serviceWorker.register('/dist/docsify/sw.js')
    }

</script>
<script src="/dist/zepto/zepto.min.js" ></script>

<script src="/dist/docsify/docsify.js" ></script>
<script src="/dist/json/jsoneditor.min.js" ></script>
<!-- å¢åŠ æ–‡æ¡£æŸ¥è¯¢ -->
<script type="text/javascript" src="/dist/docsify/plugins/search.min.js"></script>
<!-- å¢åŠ emoji,è¡¨æƒ…è§£æ -->
<script type="text/javascript" src="/dist/docsify/plugins/emoji.js"></script>
<!-- å¤–é“¾è„šæœ¬ - External Script å¦‚æœæ–‡æ¡£é‡Œçš„ script æ˜¯å†…è”è„šæœ¬ï¼Œå¯ä»¥ç›´æ¥æ‰§è¡Œï¼›è€Œå¦‚æœæ˜¯å¤–é“¾è„šæœ¬ï¼ˆå³ js æ–‡ä»¶å†…å®¹ç”± src å±æ€§å¼•å…¥ï¼‰ï¼Œåˆ™éœ€è¦ä½¿ç”¨æ­¤æ’ä»¶ã€‚ -->
<script type="text/javascript" src="/dist/docsify/plugins/external-script.js"></script>
<!-- å›¾ç‰‡ç¼©æ”¾ - Zoom imageMedium's é£æ ¼çš„å›¾ç‰‡ç¼©æ”¾æ’ä»¶. åŸºäº zoom-imageã€‚ -->
<!-- ä»£ç é«˜äº®.é»˜è®¤æ”¯æŒ CSSã€JavaScript å’Œ HTML.å…¶ä»–æ‰©å±• -->
<script type="text/javascript" src="/dist/fetch/fetch.js"></script>
<script src="https://cdn.bootcss.com/Chart.js/2.7.2/Chart.min.js"></script>
<script src="https://cdn.bootcss.com/moment.js/2.19.0/moment.min.js"></script>
<script src="/dist/system/system.js"></script>
<!--<script src="https://cdn.bootcss.com/amazeui/2.7.2/js/amazeui.min.js"></script>-->
<script>
    mermaid.initialize({
        startOnLoad: false,
        theme: 'forest',
        flowchart:{
            useMaxWidth:true,
            htmlLabels:true
        }
    });
    /**å°è£…ajax*/
    var requestByJson;
    requestByJson = function (req, fun) {
        fun.success = fun.success || function (req) {
            console.log('è·å–æˆåŠŸ')
        };
        fun.cancel = fun.cancel || function (req) {
            console.log('æ“ä½œå–æ¶ˆ')
        };
        fun.fail = fun.fail || function (req) {
            console.log('æ“ä½œå¤±è´¥')
        };
        var body = null;
        if (req.body) {
            body = JSON.stringify(req.body);
        }
       var token =  sessionStorage.getItem('security_authorization');
        fetch(baseDomain + req.url, {
            method: req.method || "POST",
            headers: {
                'Content-Type': req.contentType || 'application/json',
                'Authorization':  (token?('Admin ' +token): '')
            },
            body: body
        }).then(function (response) {
            return response.json()
        }).then(function (data) {
            var code = data.status;
            if (code == 200) {
                fun.success(req, data);
            } else if (code == 401 || code == 403) {
                window.location.href = baseDomain + "monitor/login.html?redirect_uri=" + window.location.href;
            } else {
                fun.fail(req, data);
            }
        }).catch(function (ex) {
            console.log('parsing failed', ex)
        })
    };

</script>

</body>
</html>
